<!-- HotSpot算法实现 -->

todo
# 枚举根节点的效率问题

影响可达性分析效率的因素：
1. *GC Roots*节点主要在全局性的引用（常量或静态属性）与执行上下文（栈帧中的本地变量表），而如今应用仅仅方法区就有数百兆，想要逐个检查必然会消耗大量时间。
2. GC停顿所带来的时间消耗，分析工作必须确保一致性，所以在分析过程中必须停止所有Java执行线程（防止对象引用在分析过程中不断变化）

目标主流JVM使用的都是准确式GC,即虚拟机知道某个数据具体类型，以此减少了定位对象的依次间接查找开销;在HotSpot的实现中，使用一组称为 *OopMap*的数据结构达到这个目的，具体做法为
- 在类加载完成时，HotSpot就将内存偏移量和对应的数据的类型计算出来
- 在JIT编译过程中，也会在特定位置记录下栈和寄存器中哪些位置时引用

在 *OopMap* 的帮助下，HotSpot可以快速准确完成 *GC Roots*的枚举

# 安全点(Safepoint)

HotSpot 并非为每条指令都生成*OopMap*，而是在特定位置记录这些信息，这些位置被称为安全点。即程序执行时只有在安全点才停顿下来开始GC。Safeponit不能太少，否则将导致GC等待时间过长，太短，则导致增大运行符合。安全点的选定基本以"是否具有让程序长时间执行的特征"为标准，而长时间执行的最明显特征时指令序列服用，如方法嗲用、循环跳转、异常跳转等，具有这些功能的指令才会产生Safepoint

